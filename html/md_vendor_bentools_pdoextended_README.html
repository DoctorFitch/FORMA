<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Forma Web: PDO Extended</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Forma Web
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_vendor_bentools_pdoextended_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PDO Extended </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A PDO extension that will help your developer's life.</p>
<p>Features :</p><ul>
<li>Several methods like sqlArray(), sqlrow(), sqlColumn(), sqlValue() that will help you to quickly retrieve a resultset</li>
<li>You can disconnect, reconnect, pause the connection.</li>
<li>Bind your values easily, example :</li>
</ul>
<div class="fragment"><div class="line">$ids = $cnx-&gt;sqlColumn(<span class="stringliteral">&quot;SELECT Id FROM table WHERE CreationDate BETWEEN ? AND ?&quot;</span>, [<span class="stringliteral">&#39;2013-01-01&#39;</span>, <span class="stringliteral">&#39;2013-06-01&#39;</span>]);</div><div class="line">$id = $cnx-&gt;sqlValue(<span class="stringliteral">&quot;SELECT Id FROM table WHERE Id = ?&quot;</span>, [35]);</div><div class="line">$id = $cnx-&gt;sqlValue(<span class="stringliteral">&quot;SELECT Id FROM table WHERE Id = ?&quot;</span>, 35); <span class="comment">// You don&#39;t need an array if you just have 1 value to bind</span></div><div class="line">$row = $cnx-&gt;sqlRow(<span class="stringliteral">&quot;SELECT * FROM table WHERE Name LIKE :Name AND Id &gt;= :Id&quot;</span>, [<span class="stringliteral">&#39;Name&#39;</span> =&gt; <span class="stringliteral">&#39;foo%&#39;</span>, <span class="stringliteral">&#39;Id&#39;</span> =&gt; 22]);</div></div><!-- fragment --><ul>
<li>Bind, Run and Debug your statements very easily :</li>
</ul>
<div class="fragment"><div class="line">$stmt = $cnx-&gt;prepare(<span class="stringliteral">&quot;SELECT Id FROM table WHERE CreationDate BETWEEN ? AND ?&quot;</span>);</div><div class="line">$ids = $stmt-&gt;sqlColumn([<span class="stringliteral">&#39;2013-01-01&#39;</span>, <span class="stringliteral">&#39;2013-06-01&#39;</span>]); <span class="comment">// Fetches Ids in an indexed array</span></div><div class="line">var_dump($stmt-&gt;debug()-&gt;preview()); <span class="comment">// SELECT Id FROM table WHERE CreationDate BETWEEN &#39;2013-01-01&#39; AND &#39;2013-06-01&#39;</span></div><div class="line">var_dump($stmt-&gt;debug()-&gt;duration); <span class="comment">// 0.004</span></div></div><!-- fragment --><ul>
<li>Create placeholders on the fly :</li>
</ul>
<div class="fragment"><div class="line">$ids = [2, 5, 8, 24, 26];</div><div class="line"><span class="keywordflow">try</span> {</div><div class="line">    $rows = $cnx-&gt;sqlArray(<span class="stringliteral">&quot;SELECT * FROM table WHERE Id IN (&quot;</span>.PDOStatementExtended::PlaceHolders($ids).<span class="stringliteral">&quot;)&quot;</span>, $ids);</div><div class="line">}</div><div class="line"><span class="keywordflow">catch</span> (StmtException $e) {</div><div class="line">    var_dump($e-&gt;getStmt()-&gt;queryString); <span class="comment">// SELECT * FROM table WHERE Id IN (?, ?, ?, ?, ?)</span></div><div class="line">    var_dump($e-&gt;getStmt()-&gt;preview()); <span class="comment">// SELECT * FROM table WHERE Id IN (2, 5, 8, 24, 26)</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Also works with strings with automatic quote wrapping</span></div><div class="line">$dates = [<span class="stringliteral">&#39;2013-01-01&#39;</span>, <span class="stringliteral">&#39;2013-06-01&#39;</span>];</div><div class="line"><span class="keywordflow">try</span> {</div><div class="line">    $rows = $cnx-&gt;sqlArray(<span class="stringliteral">&quot;SELECT * FROM table WHERE CreationDate IN (&quot;</span>.PDOStatementExtended::PlaceHolders($dates).<span class="stringliteral">&quot;)&quot;</span>, $dates);</div><div class="line">}</div><div class="line"><span class="keywordflow">catch</span> (StmtException $e) {</div><div class="line">    var_dump($e-&gt;getStmt()-&gt;queryString); <span class="comment">// SELECT * FROM table WHERE CreationDate IN (?, ?)</span></div><div class="line">    var_dump($e-&gt;getStmt()-&gt;preview()); <span class="comment">// SELECT * FROM table WHERE CreationDate IN (&#39;2013-01-01&#39;, &#39;2013-06-01&#39;)</span></div><div class="line">}</div></div><!-- fragment --><ul>
<li>You no longer need to deal with PDO::PARAM_INT, PDO::PARAM_STRING etc. since the PDO type is automatically set depending on the PHP type.</li>
<li>Each query you submit to the prepare() and sql() methods are hashed and stored for later re-use. Example :</li>
</ul>
<div class="fragment"><div class="line">$cnx-&gt;sqlArray(<span class="stringliteral">&quot;SELECT * WHERE foo = ?&quot;</span>, <span class="stringliteral">&#39;bar&#39;</span>); <span class="comment">// &quot;SELECT * WHERE foo = ?&quot; string is prepared and transformed to a PDOStatementExtended object</span></div><div class="line">$cnx-&gt;sqlArray(<span class="stringliteral">&quot;SELECT * WHERE foo = ?&quot;</span>, <span class="stringliteral">&#39;baz&#39;</span>); <span class="comment">// &quot;SELECT * WHERE foo = ?&quot; now matches an existing PDOStatementExtended object previously stored and doesn&#39;t have to be prepared again</span></div></div><!-- fragment --><ul>
<li>This behaviour may be disabled or enabled at any time (enabled by default) :</li>
</ul>
<div class="fragment"><div class="line">$cnx-&gt;storeStmts(<span class="keyword">false</span>); <span class="comment">// or true</span></div></div><!-- fragment --><ul>
<li>You can also import an existing PDO instance, avoiding you to have a 2nd connection :</li>
</ul>
<div class="fragment"><div class="line"><a class="code" href="config_8php.html#a5766efd703cef0e00bfc06b3f3acbe0e">$pdo</a>    =   new \PDO(<span class="stringliteral">&#39;mysql:host=localhost&#39;</span>, <span class="stringliteral">&#39;user&#39;</span>, <span class="stringliteral">&#39;password&#39;</span>);</div><div class="line">$cnx    =   PDOExtended\PDOExtended::NewInstanceFromPdo(<a class="code" href="config_8php.html#a5766efd703cef0e00bfc06b3f3acbe0e">$pdo</a>);</div></div><!-- fragment --><p>Full Example usage :</p>
<p>```php</p>
<p>define('PDO_DSN', 'mysql:host=localhost;dbname=test'); define('PDO_USERNAME', 'root'); define('PDO_PASSWORD', null);</p>
<p>// Normal call $cnx = new PDOExtended(PDO_DSN, PDO_USERNAME, PDO_PASSWORD);</p>
<p>// Let's create our working table... $cnx-&gt;sql("CREATE TABLE IF NOT EXISTS TVSeries ( Id TINYINT(3) UNSIGNED NOT NULL AUTO_INCREMENT, Name VARCHAR(255), Channel VARCHAR(40), PRIMARY KEY (Id), UNIQUE (Name) ) ENGINE=InnoDb");</p>
<p>// Example of insert with a prepared statement $insertStmt = $cnx-&gt;Prepare("INSERT IGNORE INTO TVSeries SET Name = ?"); $tvSeries = Array('Games Of Thrones', 'The Big Bang Theory', 'Dexter');</p>
<p>// For each Series, we play the insert statement with a different value foreach ($tvSeries AS $series) $insertStmt-&gt;sql($series); // $series is mapped to the "Name" bound value - since it's a string, it'll be bound as PDO::PARAM_STR // If $series was an integer, it'd be bound as PDO::PARAM_INT automatically</p>
<p>// The expected parameter may also be an array, in case you have more values to bind $insertStmt = $cnx-&gt;Prepare("INSERT IGNORE INTO TVSeries SET Name = :Name"); foreach ($tvSeries AS $series) $insertStmt-&gt;sql(Array('Name' =&gt; $series));</p>
<p>// Now, let's update the previous rows with the Channel info. $channels = Array('HBO', 'CBS', 'ShowTime');</p>
<p>// You're not obliged to prepare your statement before executing them. It's the sql() method's job. $cnx-&gt;sql("UPDATE TVSeries SET Channel = ? WHERE Name = ?", Array($channels[0], $tvSeries[0])); $cnx-&gt;sql("UPDATE TVSeries SET Channel = :Channel WHERE Name LIKE :Name", Array('Channel' =&gt; $channels[1], 'Name' =&gt; $tvSeries[1])); $cnx-&gt;sql("UPDATE TVSeries SET Channel = :Channel WHERE Id = :Id", Array('Channel' =&gt; $channels[2], 'Id' =&gt; 3)); // Id will be cast as PDO::PARAM_INT because 2 is a PHP integer</p>
<p>// Now, let's easily retrieve some infos.</p>
<p>// All the table into a multidimensionnal array. var_dump($cnx-&gt;sqlArray("SELECT * FROM TVSeries"));</p>
<p>// Juste the Big bang theory row var_dump($cnx-&gt;sqlRow("SELECT * FROM TVSeries WHERE Id = ?", 2));</p>
<p>// A list of series var_dump($cnx-&gt;sqlColumn("SELECT Name FROM TVSeries WHERE Channel IN (". PDOStatementExtended::PlaceHolders($channels) .")", $channels)); // PlaceHolders function will output "IN (?, ?, ?)";</p>
<p>// What's the channel of Dexter ? var_dump($cnx-&gt;sqlValue("SELECT Channel FROM TVSeries WHERE Name LIKE :Name", Array('Name' =&gt; 'Dexter')));</p>
<p>// Another way to request it var_dump($cnx-&gt;sqlValue("SELECT Channel FROM TVSeries WHERE Name LIKE ?", Array('Dexter')));</p>
<p>// Another way to request it var_dump($cnx-&gt;sqlValue("SELECT Channel FROM TVSeries WHERE Name LIKE ?", 'Dexter'));</p>
<p>// Association key =&gt; value var_dump($cnx-&gt;sqlAssoc("SELECT Channel, Name FROM TVSeries WHERE Id = ?", 3));</p>
<p>// Association key =&gt; associative array var_dump($cnx-&gt;sqlAssoc("SELECT Channel, Id, Name FROM TVSeries WHERE Id = ?", 3, PDOExtended::TO_ARRAY_ASSOC));</p>
<p>// Association key =&gt; indexed array var_dump($cnx-&gt;sqlAssoc("SELECT Channel, Id, Name FROM TVSeries WHERE Id = ?", 3, PDOExtended::TO_ARRAY_INDEX));</p>
<p>// Association key =&gt; stdClass var_dump($cnx-&gt;sqlAssoc("SELECT Channel, Id, Name FROM TVSeries WHERE Id = ?", 3, PDOExtended::TO_STDCLASS));</p>
<p>// Association key =&gt; value, multiline version (array of keys =&gt; values) var_dump($cnx-&gt;sqlMultiAssoc("SELECT Channel, Name FROM TVSeries WHERE Id IN (?, ?)", Array(1, 2)));</p>
<p>// Association key =&gt; associative array, multiline version (array of keys =&gt; associative arrays) var_dump($cnx-&gt;sqlMultiAssoc("SELECT Channel, Id, Name FROM TVSeries WHERE Id IN (?, ?)", Array(1, 2), PDOExtended::TO_ARRAY_ASSOC));</p>
<p>// Association key =&gt; indexed array, multiline version (array of keys =&gt; indexed arrays) var_dump($cnx-&gt;sqlMultiAssoc("SELECT Channel, Id, Name FROM TVSeries WHERE Id IN (?, ?)", Array(1, 2), PDOExtended::TO_ARRAY_INDEX));</p>
<p>// Association key =&gt; stdClass, multiline version (array of keys =&gt; stdClasses) var_dump($cnx-&gt;sqlMultiAssoc("SELECT Channel, Id, Name FROM TVSeries WHERE Id IN (?, ?)", Array(1, 2), PDOExtended::TO_STDCLASS));</p>
<p>// You can also invoke all theses methods from a PDOStatementExtended object var_dump($cnx-&gt;prepare("SELECT Channel, Id, Name FROM TVSeries WHERE Id IN (?, ?)")-&gt;sqlMultiAssoc(Array(2, 3), PDOExtended::TO_STDCLASS));</p>
<p>// How long the query has taken ? $stmt = $cnx-&gt;prepare("SELECT * FROM TVSeries WHERE Id = :Id OR Name LIKE :Name"); $res = $stmt-&gt;sqlArray(Array('Id' =&gt; 1, 'Name' =&gt; 'Dexter')); var_dump($stmt-&gt;getDuration());</p>
<p>// What was the real query played ? var_dump($stmt-&gt;<a class="el" href="jquery-form_8min_8js.html#a53b44cee4680f1f3f999890a3f249ef4">debug()</a>-&gt;preview());</p>
<p>// You can disconnect : every call afterwards will result in a PDO Exception until you invoke the Reconnect() method $cnx-&gt;<a class="el" href="select2_8min_8js.html#a77b0811f10a684d5636048e04635a73e">disconnect()</a>;</p>
<p>// You can also Pause the connection. It actually disconnects from MySQl, but on the next call (sql, query, sqlArray etc) the connect() method will automatically be called so you never have a "not connected" exception thrown $cnx-&gt;<a class="el" href="raphael_8min_8js.html#aeea0d8cc242db20d59a6ac4490f5104e">pause()</a>;</p>
<p>// Why doing this ? When you have a big treatment to do (parsing a big xml for instance), this prevents from getting "sleep connections" issues</p>
<p>// Every other PDO method is available... $cnx-&gt;query() ou $cnx-&gt;setAttribute(), etc.</p>
<h2>Installation </h2>
<p>Add the following line into your composer.json : </p><pre class="fragment">{
    "require": {
        "bentools/pdoextended": "dev-master"
    }
}  
</pre><p>Enjoy. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
